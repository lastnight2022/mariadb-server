#
# Basic SYS_REFCURSOR features, like mixing with other data types
#

--echo #
--echo # Error: SYS_REFCURSOR is not allowed in a table column
--echo #

--error ER_ILLEGAL_PARAMETER_DATA_TYPE_FOR_OPERATION
CREATE TABLE t1 (a SYS_REFCURSOR);


DELIMITER $$;
--error ER_ILLEGAL_PARAMETER_DATA_TYPE_FOR_OPERATION
BEGIN NOT ATOMIC
  DECLARE c0 SYS_REFCURSOR;
  CREATE TABLE t1 AS SELECT c0;
  SHOW CREATE TABLE t1;
END;
$$
DELIMITER ;$$

# TODO: this should fail
DELIMITER $$;
BEGIN NOT ATOMIC
  DECLARE c0 SYS_REFCURSOR;
  SELECT c0;
END;
$$
DELIMITER ;$$

DELIMITER $$;
--error ER_ILLEGAL_PARAMETER_DATA_TYPES2_FOR_OPERATION
BEGIN NOT ATOMIC
  DECLARE c SYS_REFCURSOR;
  DECLARE i INT;
  SELECT c + i;
END;
$$
DELIMITER ;$$

DELIMITER $$;
--error ER_ILLEGAL_PARAMETER_DATA_TYPES2_FOR_OPERATION
BEGIN NOT ATOMIC
  DECLARE c SYS_REFCURSOR;
  IF c = TRUE THEN
    SELECT 'TRUE';
  ELSE
    SELECT 'NOT TRUE';
  END IF;
END;
$$
DELIMITER ;$$

# TODO: this should fail
#DELIMITER $$;
#BEGIN NOT ATOMIC
#  DECLARE c SYS_REFCURSOR;
#  IF (c) THEN
#    SELECT 'TRUE';
#  ELSE
#    SELECT 'NOT TRUE';
#  END IF;
#END;
#$$
#DELIMITER ;$$

# TODO: this should fail
#DELIMITER $$;
#BEGIN NOT ATOMIC
#  DECLARE c SYS_REFCURSOR;
#  IF c IS TRUE THEN
#    SELECT 'TRUE';
#  ELSE
#    SELECT 'NOT TRUE';
#  END IF;
#END;
#$$
#DELIMITER ;$$
